# Training Quickstart

`train_simple_model.py` trains a baseline transaction-monitoring classifier on the CSVs generated by AMLSim. It expects the files that `scripts/convert_logs.py` emits (e.g., `transactions.csv`, `accounts.csv`) inside `outputs/<simulation_name>/`.

## Install dependencies

From the repository root:

```bash
pip3 install -r requirements.txt
```

## Train a model

```bash
python3 training/train_simple_model.py --simulation-name sample
```

Key options:

- `--outputs-dir`: location of the simulation outputs (default: `outputs`).
- `--simulation-name`: subdirectory inside the outputs folder (default: `sample`).
- `--model-dir`: directory where the fitted model (`*.joblib`) and metrics JSON will be stored (default: `training/models`).
- `--test-size`: fraction of samples held out for evaluation (default: `0.2`).

After the run completes you will see:

- `training/models/<simulation_name>_logreg.joblib` – serialized scikit-learn pipeline.
- `training/models/<simulation_name>_metrics.json` – ROC AUC, PR AUC, class count, and the full classification report.

You can load the model later using `joblib.load()` and call `predict`/`predict_proba` on new AMLSim-style transaction rows prepared with the same schema.
